\documentclass[letterpaper,11pt]{article}
\usepackage{graphicx}
\usepackage{listings}
\usepackage[super]{nth}
\usepackage[hyphens]{url}
\usepackage{hyperref}
\usepackage{amsmath}
\usepackage[makeroom]{cancel}
\usepackage[table]{xcolor}
\usepackage{comment}
\usepackage[space]{grffile}
\usepackage{csvsimple}

\newcommand*{\srcPath}{../src}%

\lstset{
	basicstyle=\footnotesize,
	breaklines=true,
}

\begin{document}

\begin{titlepage}

\begin{center}

\Huge{Assignment 4}

\Large{CS 532:  Introduction to Web Science}

\Large{Spring 2017}

\Large{Grant Atkins}

\Large Finished on \today

\end{center}

\end{titlepage}

\newpage


% =================================
% First question
% =================================
\section*{1}


\subsection*{Question}

\begin{verbatim}
1.  Determine if the friendship paradox holds for my Facebook
account.* Compute the mean, standard deviation, and median of the
number of friends that my friends have.  Create a graph of the
number of friends (y-axis) and the friends themselves, sorted by
number of friends (x-axis).  (The friends don't need to be labeled
on the x-axis: just f1, f2, f3, ... fn.)  Do include me in the graph
and label me accordingly.

* = This used to be more interesting when you could more easily download
your friend's friends data from Facebook.  Facebook now requires each
friend to approve this operation, effectively making it impossible.

I will email to the list the XML file that contains my Facebook
friendship graph ca. Oct, 2013.  The interesting part of the file looks
like this (for 1 friend):

<node id="Johan_Bollen_1448621116">
        <data key="Label">Johan Bollen</data>
        <data key="uid"><![CDATA[1448621116]]></data>
        <data key="name"><![CDATA[Johan Bollen]]></data>
        <data key="mutual_friend_count"><![CDATA[37]]></data>
        <data key="friend_count"><![CDATA[420]]></data>
</node>

It is in GraphML format: http://graphml.graphdrawing.org/
\end{verbatim}

\subsection*{Answer}

It should be noted that the number of nodes that the \textbf{mln.graphml} file provided was 165, but you'll notice my graph only goes up to 155. This is taken from the fact that some of the nodes in the xml file didn't have a friend count so they weren't included in this set.

To handle the first part of this problem, downloading the 1000 URIs collected from Assignment \#2, I decided to write a shell script as shown in Listing \ref{lst:q1download}. The script first starts by creating directories if the directory is not found and a CSV file to store key pairs of URI and md5 hash value calculated later. It then iterates through each URI in my collection and is eventually saved to a folder containing all 1000 URIs html content. 

For each URI in the collection it will: 
\begin{enumerate}
    \item Create an md5 hash for the URI
    \item Add the URI and md5 hash to a CSV
    \item Perform a curl HTTP get request to get the html content
    \item Save the html content to file named by the md5 hash and ``.html'' extension
\end{enumerate}

It should be noted that the curl HTTP get request used the User-Agent ``Mozilla/5.0'' along with the \emph{-L} and \emph{-m} arguments. I decided to add -L, which follows redirects, to this script because I noticed that some links have actually already changed locations and resulted in a 303 response, location change, when requested. I also added the -m argument, which sets the maximum time a connection can last, mainly due to the fact that some of these URIs were actually streaming data like live music or some radio station and it would continually retrieve data \cite{curlref}. I set the maximum time to 3 seconds to retrieve the necessary information

\lstinputlisting[frame=single,caption={Shell script for downloading 1000 URI html content},label=lst:q1download,captionpos=b,numbers=left,showspaces=false,showstringspaces=false,basicstyle=\footnotesize]{\srcPath/downloadHtml.sh}

For the second part of this problem I decided to write a script in python 3.6 using the dependency BeautifulSoup for html parsing. The script starts by iterating through the files in the html directory created in part 1 of this problem. Using code provided from a Stackoverflow.com post, I created a list of lines that were derived from the encapsulated text in each html element \cite{}. I would then iterate through each of these lines and saved them to a new file with the same md5 hash name as the file it received this information from, this time saving it with the ``.txt'' extension. If the lines created were blank I ignored them and didn't add them to this new file. This script, processHtml.py, is shown in Listing \ref{lst:q1process}.

As mentioned before some of these websites were actually streaming data which also resulted in the html content to not always be the same encoding type. A majority of the documents used UTF-8 encoding while some didn't. Therefore to compensate for this, I checked the exception that the text retrieved might not be UTF-8 and simply discarded it if it was not. 

\lstinputlisting[frame=single,caption={Python script for removing duplicates in data files},label=lst:q1process,captionpos=b,numbers=left,showspaces=false,showstringspaces=false,basicstyle=\footnotesize]{\srcPath/processHtml.py}


\clearpage

% =================================
% Second question
% =================================

\section*{2}

\subsection*{Question}

\begin{verbatim}
2.  Determine if the friendship paradox holds for your Twitter account.
Since Twitter is a directed graph, use "followers" as value you measure
(i.e., "do your followers have more followers than you?").

Generate the same graph as in question #1, and calcuate the same 
mean, standard deviation, and median values.

For the Twitter 1.1 API to help gather this data, see:

https://dev.twitter.com/docs/api/1.1/get/followers/list

If you do not have followers on Twitter (or don't have more than 50),
then use my twitter account "phonedude_mln".
\end{verbatim}

\subsection*{Answer}

Since my twitter account had no followers, I used Dr. Nelson's twitter account ``phonedude_mln'' for this problem. 		



\clearpage

% =================================
% Third question
% =================================

\section*{3}

\subsection*{Question}

\begin{verbatim}
Extra credit, 1 point:

5.  Repeat question #2, but change "followers" to "following"?  In
other words, are the people I am following following more people?
\end{verbatim}

\clearpage
\subsection*{Answer}


\clearpage

% =================================
% Bibliography
% =================================

\begin{thebibliography}{9}
\bibitem{finalurisref}
Nelson, Michael. ``Facebook Friends GraphML.'' cs532-s17 Github Repository. N.p., 1 March. 2017. Web. 1 March 2017.\url{https://github.com/grantat/cs532-s17/blob/master/assignments/A3/src/output/mln.graphml}.
\bibitem{pygraphml}
Mary, Hadrien. ``pygraphml â€“ API documentation.''N.p., n.d. Web. 1 March 2017 \url{http://hadim.fr/pygraphml/reference.html}.
\bibitem{eyedomainref}
``Check last known Google PageRank.'' eyedomain. EyeDomain, n.d. Web. 22 Feb. 2017. \url{http://pr.eyedomain.com/}.
\bibitem{worldwidewebsizeref}
Kunder, Maurice. ``The size of the Dutch World Wide Web'' worldwidwebsize. N.p., n.d. Web. 22 Feb. 2017.\url{http://www.worldwidewebsize.com/}.
\bibitem{curlref} 
Stenberg, Daniel. ``Curl.1 the Man Page.'' Curl - How To Use. N.p., n.d. Web. 24 Jan. 2017. \url{https://curl.haxx.se/docs/manpage.html}.
\end{thebibliography}

\end{document}